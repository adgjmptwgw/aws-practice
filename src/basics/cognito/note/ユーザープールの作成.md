# 概要
コンソール上で「ユーザープールを作成」を実施する際の各種項目を解説する。

# 前提知識
## 各種トークン
### ● IDトークン
- いわゆる「認可」用のトークン。このトークンの有効期限が切れるとログイン状態を維持できなくなる。
- API Gatewayのオーソライザーを使用する際、Authorization Headerに渡す。（アクセストークンでも可？？？）  

ログイン後、下記画像の②で取得したIDトークンをAuthorization Headerに渡す。③でAPI Gateway経由で④のオーソライザーに渡す。  
![image](https://github.com/adgjmptwgw/aws-practice/assets/66456130/28699ec9-2367-43fb-895a-d6cc18ad5d8e)


### ● アクセストークン
- ユーザープールの属性（ユーザ名、電話番号、ニックネーム、メールアドレス）を変更するAPI実行時に使う。

### ● リフレッシュトークン
- IDトークン、アクセストークンを更新してくれるトークン
- このトークンの有効期限が切れると、それ以上トークンの更新ができない為、事実上のログアウトとなる。
- フロントエンドでは、npm の ```aws-amplify``` というライブラリを使用する際、下記のSDKを実行すればIDトークンとアクセストークンを自動で更新してくれる。（リフレッシュトークンの有効期限が残っている場合のみ）
```
const user = await Auth.currentSession()
```


# 手順

## セキュリティ要件を設定
### 多要素認証
- MFA の方法
  - Authenticator アプリケーション
    - WinAuth、Authy の様なMFA認証アプリを用いて、MFA認証を行う方法
  - SMS メッセージ
    - パスワード、IDを入力後にコードSMSにコードが届く

## セルフサービスのサインアップ
### 自己登録
Host UI の時だけ必要な設定？？？  
- 自己登録を有効化
  - 有効化すると、一般的なアプリと同じでユーザーが自分でアカウント登録（サインアップ）をできるようになる。基本的には「有効」に設定する。
  - 無効化すると、アプリ管理者や開発者がマネージメントコンソール、CLI、APIなどを利用して、ユーザーを作成する必要がある。
