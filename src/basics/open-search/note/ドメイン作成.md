# 概要
OpenSearchを使用するにあたり、ドメイン（クラスター）を作成する必要がある。
ドメインとは何なのか。作成方法や設定のオプションについてここで記述する。

# 前提知識
## OpenSearch 構成
- マスターノード
  - インデックスの作成、削除
  - シャードの割り当て
  - マスターノードがあることで、データノードの可用性が高まる
- データノード
  - インデックスデータの保持
  - インデックスデータのCRUD、検索、集計
- シャード
  - データノードの中にあり、インデックスが保管されている
  - プライマリーとレプリカ用の2つがある

![image](https://github.com/adgjmptwgw/aws-practice/assets/66456130/fbcf487a-7373-456a-88ca-b1ab8854a187)
![image](https://github.com/adgjmptwgw/aws-practice/assets/66456130/c5f6360e-8ae3-4887-8ad5-b68f430e3ce2)

## データノードの構成
- **インデックス**
  - RDSのテーブルの様なもの
- **ドキュメント**
  - レコードの様なもの
- **フィールド**
  - カラムの様なもの
 
## この構成のメリット
- もし、データノードの1つが停止してもプライマリーシャードとレプリカシャードが分割されている為、データノード停止の影響を受けない。その為、可用性が高い。
- より高速な処理を実行したい場合、データノード（CPU、メモリ）を増やすことができ、拡張性も高い。

## インフラ構成
下記の様な方法でOpenSearchのドメインにアクセスできます。
- Lambda / API Gateway等でRest APIを構築して、直接OpenSearchにアクセスする
- プライベートサブネット内のEC2、ECSからアクセスする

![image](https://github.com/adgjmptwgw/aws-practice/assets/66456130/9fbd0933-724a-451a-a55c-9afbd5c5d668)

# ドメインの作成手順


