# 概要
コンソール上でサービスの「作成」を実施する際の各種項目を解説する。
※起動タイプはFargate

# 前提知識
TBD

# 手順

# メモ
ALBに紐づくタスクやコンテナを2つ以上作成する際はコンソールからは作成できない為、下記の様なコマンドでサービスを作成する。

**参考資料**  
[**公式:CreateServiceパラメータ**](https://docs.aws.amazon.com/ja_jp/AmazonECS/latest/APIReference/API_CreateService.html)

**【サービス作成コマンド】**
```
aws ecs create-service \
--service-name <サービス名> \
--cluster <クラスター名> \
--task-definition <タスク定義名>:<リビジョン番号> \
--desired-count <タスク数> \
--launch-type <EC2 or FARGATE or EXTERNAL> \
--network-configuration 'awsvpcConfiguration={subnets=[<ECSを配置するパブリックサブネットID>],securityGroups=[<ECSのセキュリティーグループID>],assignPublicIp=ENABLED}' \
--load-balancers '[{"targetGroupArn": "<ターゲットグループARN>", "containerName": "<コンテナ名>", "containerPort": <ポート番号>},{"targetGroupArn": "<ターゲットグループARN>", "containerName": "<コンテナ名>", "containerPort": <ポート番号>}]'
```

**【例】**
```
aws ecs create-service \
--service-name ecs-service-1 \
--cluster h4b-ecs-cluster \
--task-definition h4b-ecs-task-definition:12 \
--desired-count 1 \
--launch-type FARGATE \
--network-configuration 'awsvpcConfiguration={subnets=[subnet-021266f238b86e215, subnet-0ea287637986f555a],securityGroups=[sg-0307aceef4b132169],assignPublicIp=ENABLED}' \
--load-balancers '[{"targetGroupArn": "arn:aws:elasticloadbalancing:ap-northeast-1:999624277949:targetgroup/h4b-ecs-target-group-80/9cc6071675b10bee", "containerName": "apache-helloworld", "containerPort": 80},{"targetGroupArn": "arn:aws:elasticloadbalancing:ap-northeast-1:999624277949:targetgroup/h4b-ecs-target-group-8080/1854175026bda713", "containerName": "apache-helloworld-2", "containerPort": 8080}]'
```
