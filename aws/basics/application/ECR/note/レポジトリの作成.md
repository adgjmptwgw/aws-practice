# 概要
コンソール上で「リポジトリ」を実施する際の各種項目を解説する。

# 前提知識
## レジストリとは
[**レジストリについてのリンク**](https://github.com/adgjmptwgw/aws-practice/blob/main/src/basics/ecr/note/%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88%E3%83%AC%E3%82%B8%E3%82%B9%E3%83%88%E3%83%AA%E3%81%AE%E5%90%84%E7%A8%AE%E9%A0%85%E7%9B%AE.md#%E3%83%AC%E3%82%B8%E3%82%B9%E3%83%88%E3%83%AA%E3%81%A8%E3%81%AF)

## 運用方法
ECRのリポジトリにPushする際はCodeBuildと連携する事が多い。  
ソースコード（Dockerfile等）をGitにPushした後、CodeBuildのbuildspec.ymlファイルに従って、イメージ（Dockerfile）をECSへ自動的にPushする。

# 手順
## 一般設定
### 可視性設定
- プライベート
- パブリック
コンテナイメージを誰でも世界中に公開し、ダウンロードすることが可能になる。

### タグのイミュータビリティ
この設定を「有効」にするとリポジトリのバージョンを上書きできなくなる。つまり。「latest」のタグを使用できない。  
そもそもバージョンを「latest」で運用する事は推奨されていない。  
ソースコードとコンテナイメージの一貫性の把握が容易になり、トラブルシューティング時に無駄な時間を使うことが減るため、「タグのイミュータビリティ」設定は「有効」に設定した方が良い。
バージョンはGitの「コミットID」と紐付けする事が多い。　　  

[**バージョン管理について**](https://dev.classmethod.jp/articles/docker-image-tag-git-commit-id-by-codebuild/)

## イメージスキャンの設定
### プッシュ時にスキャン
リポジトリにPushした時に自動で脆弱性スキャンを実施してくれる設定。  
現在脆弱性スキャンはリポジトリ単位ではなく、レジストリで設定して実行する事が推奨されている。

## 暗号化設定
### KMS 暗号化
TBD

